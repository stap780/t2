<%= turbo_frame_tag "offcanvas" do %>
  <div class="p-4">
    <h2 class="text-xl font-semibold mb-4"><%= t('print_barcode') %></h2>
    <% if @success && @blob %>
      <div class="space-y-4">
        <p class="text-sm text-gray-600">
          <%= t('etiketka_generated_successfully', default: 'Этикетка успешно сгенерирована') %>
        </p>
        <div class="flex justify-center">
          <iframe 
            src="<%= rails_blob_path(@blob, disposition: 'inline') %>" 
            class="w-full h-96 border rounded"
            type="application/pdf">
          </iframe>
        </div>
        <div class="flex justify-center space-x-2">
          <%= link_to t('download', default: 'Скачать'), rails_blob_path(@blob, disposition: 'attachment'), 
              class: "px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600" %>
        </div>
      </div>
    <% else %>
      <div class="text-red-600">
        <p><%= t('error_generating_etiketka', default: 'Ошибка при генерации этикетки') %></p>
        <% if @error_message.is_a?(Array) %>
          <ul class="list-disc list-inside mt-2">
            <% @error_message.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        <% elsif @error_message.present? %>
          <p class="mt-2"><%= @error_message %></p>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>

